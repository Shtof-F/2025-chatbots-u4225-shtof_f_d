University: [ITMO University](https://itmo.ru/ru/)  
Faculty: [FICT](https://fict.itmo.ru)  
Course: [Vibe Coding: AI-боты для бизнеса](https://github.com/itmo-ict-faculty/vibe-coding-for-business)  
Year: 2025/2026  
Group: U4225  
Author: Shtof Fedor Danilovich  
Lab: Lab1  
Date of create: 09.11.2025  
Date of finished: 09.11.2025

# Отчет о проекте: Telegram-бот помощник для команды

## Описание задачи

### Какую проблему решает бот

Telegram-бот решает несколько проблем команды разработки:

1. **Потеря информации о компании/проекте** - Новые сотрудники или члены команды часто задают одни и те же вопросы о компании, проекте, процессах. Бот централизует эту информацию и предоставляет быстрый доступ к ответам.

2. **Отсутствие единой базы контактов** - Контактная информация коллег часто хранится в разных местах (личные контакты, мессенджеры, документы). Бот создает единую базу контактов, доступную всей команде.

3. **Забывание важных событий** - Планирование встреч, дедлайнов, митингов требует постоянного напоминания. Бот хранит события и напоминает о них.

4. **Отсутствие структурированных дайджестов** - Важная информация о работе команды часто теряется в потоке сообщений. Бот позволяет сохранять и просматривать дайджесты.

### Почему выбрали именно эту задачу

- **Актуальность**: Проблема организации информации в команде актуальна для любой рабочей группы
- **Практическая польза**: Бот решает реальные проблемы, с которыми сталкиваются команды
- **Масштабируемость**: Функционал можно легко расширять новыми возможностями
- **Обучение**: Проект охватывает множество аспектов разработки (БД, API, обработка ошибок, UX)

---

## Промпт для LLM

### Исходный промпт

```
Создай Telegram-бота на Python с использованием библиотеки python-telegram-bot.

Функционал бота:
- Отвечает на вопросы о компании/проекте/команде
- Хранит контакты коллег
- Напоминает о важных событиях
- Отправляет ежедневные дайджесты

Требования:
- Бот должен быть простым и понятным
- Код должен быть хорошо прокомментирован
- Использовать файл для хранения данных (SQLite)
- Добавить обработку ошибок

Создай:
1. Файл bot.py с кодом бота
2. Файл requirements.txt с зависимостями
3. Файл README.md с инструкцией по запуску
4. Файл .env.example для примера конфигурации
```

### Итерации и улучшения

В процессе разработки были внесены следующие улучшения:

1. **Улучшение парсинга вопросов/ответов**:
   - Проблема: Пользователи вводили "Вопрос:" и "Ответ:" с разным регистром, бот не распознавал формат
   - Решение: Использование регулярных выражений с case-insensitive поиском

2. **Исправление сохранения событий**:
   - Проблема: События не сохранялись в БД из-за неправильного формата даты
   - Решение: Сохранение дат в ISO формате и правильное сравнение при запросах

3. **Расширение диапазона показа событий**:
   - Проблема: Показывались только события на 7 дней вперед
   - Решение: Изменение логики для показа всех будущих событий

### Финальный промпт

После итераций промпт остался практически без изменений, так как исходный промпт был достаточно детальным. Основные улучшения касались исправления багов, обнаруженных при тестировании.

---

## Стек технологий

### Какие библиотеки использовались

1. **python-telegram-bot (v20.7)**
   - Основная библиотека для работы с Telegram Bot API
   - Предоставляет удобный асинхронный интерфейс
   - Поддерживает все современные возможности Telegram API

2. **python-dotenv (v1.0.0)**
   - Загрузка переменных окружения из файла .env
   - Безопасное хранение токена бота

3. **SQLite3 (встроенная)**
   - Легковесная база данных для хранения данных
   - Не требует отдельного сервера
   - Идеально для небольших проектов

4. **Стандартная библиотека Python**:
   - `datetime` - работа с датами и временем
   - `logging` - логирование событий и ошибок
   - `re` - регулярные выражения для парсинга
   - `os` - работа с переменными окружения
   - `sqlite3` - работа с базой данных
   - `typing` - типизация для лучшей читаемости кода

### Почему выбрали именно их

1. **python-telegram-bot**:
   - Официально рекомендуемая библиотека для Python
   - Активная поддержка и обновления
   - Хорошая документация
   - Асинхронная архитектура для лучшей производительности

2. **SQLite**:
   - Не требует настройки сервера БД
   - Файловая база данных - легко переносить и бэкапить
   - Достаточно для хранения данных команды
   - Встроена в Python

3. **python-dotenv**:
   - Стандартная практика для хранения секретов
   - Удобство при разработке и деплое
   - Безопасность (не коммитить токены в репозиторий)

---

## Скриншоты и видео

### Скриншоты работы бота

Основные функций бота:

1. **Команда /start** - Приветственное сообщение с списком команд
2. **Добавление вопроса/ответа** - Процесс добавления информации через /answer
3. **Просмотр контактов** - Список всех сохраненных контактов через /contacts
4. **Добавление события** - Диалог добавления события через /add_event
5. **Просмотр событий** - Список предстоящих событий через /events
6. **Добавление дайджеста** - Процесс добавления дайджеста через /add_digest


### Видео-демо

*Здесь можно добавить ссылку на видео-демонстрацию работы бота (YouTube/Google Drive)*

---

## Трудности и решения

### С какими проблемами столкнулись

1. **Проблема с парсингом вопросов/ответов**
   - **Описание**: Пользователи вводили "Вопрос:" и "Ответ:" с разным регистром, бот выдавал ошибку "неверный формат"
   - **Причина**: Использование простого `split()` было чувствительно к регистру и пробелам
   - **Решение**: Использование регулярных выражений с флагом `re.IGNORECASE` для регистронезависимого поиска и правильной обработки пробелов

2. **События не сохранялись в БД**
   - **Описание**: После добавления события через `/add_event`, команда `/events` не показывала добавленные события
   - **Причина**: Объекты `datetime` сохранялись напрямую в SQLite, что приводило к проблемам при сравнении дат в SQL-запросах
   - **Решение**: Сохранение дат в ISO формате (строки) с помощью `datetime.isoformat()` и правильное сравнение строк в SQL-запросах

3. **Ограничение показа событий**
   - **Описание**: Показывались только события на 7 дней вперед, дальние события не отображались
   - **Причина**: Жестко заданный параметр `days=7` в функции `get_upcoming_events()`
   - **Решение**: Добавление параметра `days=None` для показа всех будущих событий

4. **Обработка ошибок парсинга дат**
   - **Описание**: При чтении старых записей из БД могли возникать ошибки парсинга дат
   - **Решение**: Добавлена обработка исключений при парсинге дат с логированием ошибок

### Как их решили

- **Итеративный подход**: Тестирование каждой функции после реализации
- **Логирование**: Добавление подробных логов для отладки
- **Обработка исключений**: Try-except блоки на всех критических участках кода
- **Валидация данных**: Проверка формата данных перед сохранением

---

## Выводы

### Что получилось хорошо

1. **Архитектура кода**:
   - Четкое разделение на классы (Database) и функции-обработчики
   - Хорошая читаемость и структурированность
   - Подробные комментарии на русском языке

2. **Функциональность**:
   - Все заявленные функции реализованы и работают
   - Удобный интерфейс с пошаговыми диалогами
   - Интуитивно понятные команды

3. **Надежность**:
   - Обработка ошибок на всех уровнях
   - Логирование для отладки
   - Валидация входных данных

4. **База данных**:
   - Правильная структура таблиц
   - Использование транзакций
   - Корректная работа с датами

### Что можно улучшить

1. **Функциональность**:
   - Добавить возможность редактирования и удаления записей
   - Реализовать поиск по вопросам (не только точное совпадение)
   - Добавить категории для событий и контактов

2. **UX/UI**:
   - Добавить inline-кнопки для более удобной навигации
   - Реализовать меню команд
   - Добавить подтверждение при удалении записей
   - Улучшить форматирование вывода (markdown)

3. **Технические улучшения**:
   - Добавить миграции БД для обновления структуры
   - Реализовать бэкап базы данных
   - Добавить unit-тесты
   - Использовать ORM (например, SQLAlchemy) вместо прямых SQL-запросов
   - Добавить конфигурационный файл для настройки параметров

4. **Безопасность**:
   - Добавить авторизацию пользователей (whitelist)
   - Ограничить доступ к некоторым командам
   - Валидация и санитизация всех входных данных

5. **Масштабируемость**:
   - Поддержка нескольких команд/проектов в одном боте
   - Экспорт/импорт данных
   - API для интеграции с другими сервисами

### Чему научились

1. **Работа с Telegram Bot API**:
   - Использование библиотеки python-telegram-bot
   - Работа с ConversationHandler для многошаговых диалогов
   - Обработка команд и сообщений

2. **Работа с базами данных**:
   - Проектирование схемы БД
   - Написание SQL-запросов
   - Работа с датами в SQLite
   - Транзакции и обработка ошибок БД

3. **Обработка ошибок**:
   - Try-except блоки
   - Логирование для отладки
   - Валидация входных данных

4. **Регулярные выражения**:
   - Использование `re` модуля
   - Case-insensitive поиск
   - Парсинг структурированного текста

5. **Асинхронное программирование**:
   - Работа с async/await
   - Асинхронные обработчики событий

6. **Организация проекта**:
   - Структура файлов
   - Управление зависимостями (requirements.txt)
   - Конфигурация через переменные окружения
   - Документация (README.md)

---

## Заключение

Проект успешно реализован и решает поставленные задачи. Бот предоставляет удобный интерфейс для хранения и получения информации о команде, контактах, событиях и дайджестах. Код хорошо структурирован, прокомментирован и готов к дальнейшему развитию.

Основные достижения:
- ✅ Все заявленные функции реализованы
- ✅ Код хорошо документирован
- ✅ Обработка ошибок на всех уровнях
- ✅ Удобный пользовательский интерфейс
- ✅ Надежное хранение данных в SQLite

Проект может быть использован как основа для более сложных ботов с расширенным функционалом.



